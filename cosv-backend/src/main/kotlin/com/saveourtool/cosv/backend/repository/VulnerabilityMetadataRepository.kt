package com.saveourtool.cosv.backend.repository

import com.saveourtool.common.entities.vulnerability.VulnerabilityStatus
import com.saveourtool.common.entitiescosv.VulnerabilityMetadata
import com.saveourtool.common.spring.repository.BaseEntityRepository

import org.springframework.stereotype.Repository

/**
 * JPA repository for [VulnerabilityMetadata]
 */
@Repository
interface VulnerabilityMetadataRepository : BaseEntityRepository<VulnerabilityMetadata> {
    /**
     * @param identifier [VulnerabilityMetadata.identifier]
     * @return found [VulnerabilityMetadata] or null
     */
    fun findByIdentifier(identifier: String): VulnerabilityMetadata?

    /**
     * @param identifier [VulnerabilityMetadata.identifier]
     */
    fun deleteByIdentifier(identifier: String)

    /**
     * @param userId creator of vulnerability
     * @return list of metadata
     */
    fun findByUserId(userId: Long): List<VulnerabilityMetadata>

    /**
     * @param userId id of user
     * @param status status of vulnerability
     * @return count of vulnerabilities
     */
    fun countByUserIdAndStatus(userId: Long, status: VulnerabilityStatus): Int
}
