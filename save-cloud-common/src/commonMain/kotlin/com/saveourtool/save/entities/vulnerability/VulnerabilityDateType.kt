package com.saveourtool.save.entities.vulnerability

import kotlin.js.JsExport
import kotlinx.serialization.Serializable

/**
 * Enum of vulnerability date type
 * @property value pretty name
 */
@Serializable
@JsExport
enum class VulnerabilityDateType(val value: String) {
    /**
     * Date in COSV's timeline with type [com.saveourtool.osv4k.TimelineEntryType.disclosed]
     */
    DISCLOSED("Disclosed"),

    /**
     * Date in COSV's timeline with type [com.saveourtool.osv4k.TimelineEntryType.fixed]
     */
    FIXED("Fixed"),

    /**
     * Date in COSV's timeline with type [com.saveourtool.osv4k.TimelineEntryType.found]
     */
    FOUND("Found"),

    /**
     * Date in COSV's timeline with type [com.saveourtool.osv4k.TimelineEntryType.introduced]
     */
    INTRODUCED("Introduced"),

    /**
     * Date from [com.saveourtool.osv4k.OsvSchema.modified] in COSV schema
     * NOT SHOWN ON THE TIMELINE!
     */
    MODIFIED("Modified"),

    /**
     * Date from [com.saveourtool.osv4k.OsvSchema.published] in COSV schema
     */
    PUBLISHED("Published"),

    /**
     * Date when the vuln was submitted to our archive, our platform specific
     */
    SUBMITTED_COSV("-> COSV"),

    /**
     * Date from [com.saveourtool.osv4k.OsvSchema.withdrawn] in COSV schema
     */
    WITHDRAWN("Withdrawn"),
    ;

    override fun toString(): String = value

    /**
     * @return true if it's [SUBMITTED_COSV] or [MODIFIED]
     */
    fun isSystemDateType() = this == SUBMITTED_COSV || this == MODIFIED
}
