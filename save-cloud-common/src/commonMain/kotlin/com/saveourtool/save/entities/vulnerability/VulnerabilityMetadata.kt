package com.saveourtool.save.entities.vulnerability

import com.saveourtool.save.entities.OrganizationDto
import com.saveourtool.save.info.UserInfo
import kotlinx.datetime.LocalDateTime
import kotlinx.serialization.Serializable

/**
 * @property name name of vulnerability
 * @property vulnerabilityIdentifier original identifier of vulnerability
 * @property progress vulnerability criticality percentage
 * @property description description of vulnerability
 * @property shortDescription
 * @property relatedLink
 * @property language
 * @property userInfo creator vulnerability
 * @property organization
 * @property participants
 * @property status
 * @property creationDateTime [LocalDateTime] of creation
 * @property lastUpdatedDateTime [LocalDateTime] of last updating
 * @property tags
 */
@Serializable
data class VulnerabilityMetadata(
    val name: String,
    val vulnerabilityIdentifier: String?,
    val progress: Int,
    val description: String?,
    val shortDescription: String,
    val relatedLink: String?,
    val language: VulnerabilityLanguage,
    val userInfo: UserInfo,
    val organization: OrganizationDto?,
    val participants: List<UserInfo>,
    val status: VulnerabilityStatus,
    val creationDateTime: LocalDateTime? = null,
    val lastUpdatedDateTime: LocalDateTime? = null,
    val tags: Set<String> = emptySet(),
) {
    companion object {
        val empty = VulnerabilityMetadata(
            "",
            "",
            0,
            "",
            "",
            null,
            VulnerabilityLanguage.OTHER,
            UserInfo(name = ""),
            null,
            emptyList(),
            VulnerabilityStatus.CREATED,
        )
    }
}
