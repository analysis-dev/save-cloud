@file:Suppress("HEADER_MISSING_IN_NON_SINGLE_CLASS_FILE")

package com.saveourtool.save.entities.cosv

import com.saveourtool.save.entities.OrganizationDto
import com.saveourtool.save.entities.vulnerability.VulnerabilityLanguage
import com.saveourtool.save.entities.vulnerability.VulnerabilityStatus
import com.saveourtool.save.info.UserInfo
import kotlinx.datetime.LocalDateTime
import kotlinx.serialization.Serializable

/**
 * @property identifier [com.saveourtool.osv4k.OsvSchema.id]
 * @property summary [com.saveourtool.osv4k.OsvSchema.summary]
 * @property details [com.saveourtool.osv4k.OsvSchema.details]
 * @property severityNum [com.saveourtool.osv4k.Severity.scoreNum]
 * @property modified [com.saveourtool.osv4k.OsvSchema.modified]
 * @property submitted
 * @property language
 * @property status
 * @property tags
 **/
@Serializable
data class VulnerabilityMetadataDto(
    val identifier: String,
    val summary: String,
    val details: String,
    val severityNum: Float,
    val modified: LocalDateTime,
    val submitted: LocalDateTime,
    val language: VulnerabilityLanguage,
    val status: VulnerabilityStatus,
    val tags: Set<String> = emptySet(),
) {
    companion object {
        /**
         * The maximum length of [summary] (and of `VulnerabilityMetadata.summary`).
         *
         * Should be consistent with _Liquibase_ definitions (`varchar(250)`).
         */
        const val SUMMARY_LENGTH = 250
    }
}

/**
 * @property vulnerabilityMetadataDto
 * @property user
 * @property organization
 **/
@Serializable
data class VulnerabilityMetadataDtoWithUserAndOrganization(
    val vulnerabilityMetadataDto: VulnerabilityMetadataDto,
    val user: UserInfo,
    val organization: OrganizationDto?,
)
