package com.saveourtool.save.entities.cosv

import com.saveourtool.osv4k.RawOsvSchema as RawCosvSchema
import com.saveourtool.save.info.UserInfo

import kotlinx.serialization.Serializable

/**
 * @property metadataDto
 * @property cosv
 * @property saveContributors save's user from [com.saveourtool.osv4k.OsvSchema.contributors]
 **/
@Serializable
data class VulnerabilityExt(
    val metadataDto: VulnerabilityMetadataDtoWithUserAndOrganization,
    val cosv: RawCosvSchema,
    val saveContributors: List<UserInfo>,
) {
    /**
     * @return contributors + owner (creator)
     */
    fun getAllParticipants() = saveContributors.plus(metadataDto.user)
}
