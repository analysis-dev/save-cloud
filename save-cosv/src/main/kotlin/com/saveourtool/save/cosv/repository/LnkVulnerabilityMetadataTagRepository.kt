package com.saveourtool.save.cosv.repository

import com.saveourtool.save.entitiescosv.LnkVulnerabilityMetadataTag
import com.saveourtool.save.spring.repository.BaseEntityRepository
import org.springframework.data.domain.Pageable
import org.springframework.stereotype.Repository

/**
 * [BaseEntityRepository] for [LnkVulnerabilityMetadataTag]
 */
@Repository
interface LnkVulnerabilityMetadataTagRepository : BaseEntityRepository<LnkVulnerabilityMetadataTag> {
    /**
     * @param vulnerabilityMetadataId id of vulnerability metadata
     * @return list of [LnkVulnerabilityMetadataTag] links to vulnerability metadata
     */
    fun findByVulnerabilityMetadataId(vulnerabilityMetadataId: Long): List<LnkVulnerabilityMetadataTag>

    /**
     * @param vulnerabilityMetadataIds ids of vulnerability metadata
     * @return list of [LnkVulnerabilityMetadataTag] links to vulnerability metadata
     */
    fun findByVulnerabilityMetadataIdIn(vulnerabilityMetadataIds: List<Long>): List<LnkVulnerabilityMetadataTag>

    /**
     * @param identifier identifier of vulnerability metadata
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findAllByVulnerabilityMetadataIdentifier(identifier: String): List<LnkVulnerabilityMetadataTag>

    /**
     * @param vulnerabilityMetadataId id of vulnerability metadata
     * @param tagId tag
     * @return [LnkVulnerabilityMetadataTag]
     */
    fun findByVulnerabilityMetadataIdAndTagId(vulnerabilityMetadataId: Long, tagId: Long): LnkVulnerabilityMetadataTag?

    /**
     * @param ids tags id
     * @param page
     * @return [List] of [LnkVulnerabilityMetadataTag]s
     */
    fun findAllByTagIdIn(ids: List<Long>, page: Pageable): List<LnkVulnerabilityMetadataTag>
}
