package com.saveourtool.save.cosv.repository

import com.saveourtool.save.entities.cosv.LnkVulnerabilityMetadataTag
import com.saveourtool.save.spring.repository.BaseEntityRepository
import org.springframework.data.domain.Pageable
import org.springframework.stereotype.Repository

/**
 * [BaseEntityRepository] for [LnkVulnerabilityMetadataTag]
 */
@Repository
interface LnkVulnerabilityMetadataTagRepository : BaseEntityRepository<LnkVulnerabilityMetadataTag> {
    /**
     * @param tagName tag
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findByTagName(tagName: String): List<LnkVulnerabilityMetadataTag>

    /**
     * @param tagNames [Set] of tags
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findByTagNameIn(tagNames: Set<String>): List<LnkVulnerabilityMetadataTag>

    /**
     * @param cosvMetadataId id of COSV metadata
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findByCosvMetadataId(cosvMetadataId: Long): List<LnkVulnerabilityMetadataTag>

    /**
     * @param cosvId id of COSV
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findAllByCosvMetadataCosvId(cosvId: String): List<LnkVulnerabilityMetadataTag>

    /**
     * @param cosvMetadataIds [List] of [CosvMetadata.id]s
     * @return list of [LnkVulnerabilityMetadataTag] links to COSV metadata
     */
    fun findByCosvMetadataIdIn(cosvMetadataIds: List<Long>): List<LnkVulnerabilityMetadataTag>

    /**
     * @param cosvMetadataId id of COSV metadata
     * @param tagName tag
     * @return [LnkVulnerabilityMetadataTag]
     */
    fun findByCosvMetadataIdAndTagName(cosvMetadataId: Long, tagName: String): LnkVulnerabilityMetadataTag?

    /**
     * @param prefix [LnkVulnerabilityMetadataTag.tag] name prefix
     * @param page
     * @return [List] of [LnkVulnerabilityMetadataTag]s with name that starts with [prefix]
     */
    fun findAllByTagNameStartingWith(prefix: String, page: Pageable): List<LnkVulnerabilityMetadataTag>
}
