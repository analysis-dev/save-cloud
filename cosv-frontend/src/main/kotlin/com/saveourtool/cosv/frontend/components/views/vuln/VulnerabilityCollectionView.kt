/**
 * View for vulnerability collection
 */

@file:Suppress("FILE_NAME_MATCH_CLASS")

package com.saveourtool.cosv.frontend.components.views.vuln

import com.saveourtool.cosv.frontend.components.basic.vulnerabilityIntroductionComponent
import com.saveourtool.save.filters.VulnerabilityFilter
import com.saveourtool.save.frontend.common.components.basic.*
import com.saveourtool.save.frontend.common.components.views.vuln.vulnerabilityTableComponent
import com.saveourtool.save.frontend.common.utils.*
import com.saveourtool.save.frontend.common.utils.Style
import com.saveourtool.save.frontend.common.utils.particles
import com.saveourtool.save.frontend.common.utils.useBackground
import com.saveourtool.save.info.UserInfo

import js.core.jso
import react.*
import react.dom.html.ReactHTML.div
import react.dom.html.ReactHTML.main
import web.cssom.*

internal val columnHeight = 63.rem

/**
 * [FC] for [vulnerabilityCollectionView]
 */
val vulnerabilityCollectionView: FC<VulnerabilityCollectionViewProps> = FC { props ->
    useBackground(Style.VULN_DARK)
    particles()

    main {
        className = ClassName("main-content mt-5 ps text-gray-800")
        div {
            className = ClassName("page-header align-items-start min-vh-100")
            div {
                className = ClassName("d-flex justify-content-center mb-1")
                div {
                    className = ClassName("col-4 align-items-stretch")
                    vulnerabilityIntroductionComponent()
                }
                div {
                    className = ClassName("card flex-md-row col-7 d-flex align-items-stretch mb-2")
                    style = jso {
                        minHeight = columnHeight
                    }
                    div {
                        className = ClassName("col")
                        div {
                            vulnerabilityTableComponent {
                                this.currentUserInfo = props.currentUserInfo
                                this.filters = props.filter
                            }
                        }
                    }
                }
            }
        }
    }
}

/**
 * [Props] of vulnerability collection view
 */
external interface VulnerabilityCollectionViewProps : Props {
    /**
     * Current logged-in user
     */
    var currentUserInfo: UserInfo?

    /**
     * All preset filters in one value [filter]
     */
    var filter: VulnerabilityFilter?
}
