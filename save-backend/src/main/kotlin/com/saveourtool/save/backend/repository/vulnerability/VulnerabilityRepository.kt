package com.saveourtool.save.backend.repository.vulnerability

import com.saveourtool.save.entities.vulnerabilities.Vulnerability
import com.saveourtool.save.entities.vulnerability.VulnerabilityStatus
import com.saveourtool.save.spring.repository.BaseEntityRepository
import org.springframework.stereotype.Repository

/**
 * Repository of vulnerabilities
 */
@Repository
interface VulnerabilityRepository : BaseEntityRepository<Vulnerability> {
    /**
     * @param identifier vulnerability identifier
     * @return vulnerability
     */
    fun findByIdentifier(identifier: String): Vulnerability?

    /**
     * @param identifier vulnerability identifier
     * @param status status of vulnerability
     * @return vulnerability
     */
    fun findByIdentifierAndStatus(identifier: String, status: VulnerabilityStatus): List<Vulnerability>

    /**
     * @param userId creator of vulnerability
     * @return list of vulnerabilities
     */
    fun findByUserId(userId: Long): List<Vulnerability>

    /**
     * @param userId id of user
     * @param status status of vulnerability
     * @return count of vulnerabilities
     */
    fun countByUserIdAndStatus(userId: Long, status: VulnerabilityStatus): Int

    /**
     * @param organizationName name of organization
     * @param status status of vulnerability
     * @return list of vulnerabilities
     */
    fun findByOrganizationNameAndStatus(organizationName: String, status: VulnerabilityStatus): List<Vulnerability>

    /**
     * @param identifierPrefix prefix of [Vulnerability.identifier]
     * @param status status of vulnerability
     * @return vulnerabilities
     */
    fun findByIdentifierStartingWithAndStatus(identifierPrefix: String, status: VulnerabilityStatus): List<Vulnerability>
}
