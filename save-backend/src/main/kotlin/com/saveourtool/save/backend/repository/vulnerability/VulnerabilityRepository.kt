package com.saveourtool.save.backend.repository.vulnerability

import com.saveourtool.save.entities.vulnerabilities.Vulnerability
import com.saveourtool.save.entities.vulnerability.VulnerabilityStatus
import com.saveourtool.save.spring.repository.BaseEntityRepository
import org.springframework.stereotype.Repository

/**
 * Repository of vulnerabilities
 */
@Repository
interface VulnerabilityRepository : BaseEntityRepository<Vulnerability> {
    /**
     * @param name name of vulnerability
     * @return vulnerability
     */
    fun findByName(name: String): Vulnerability?

    /**
     * @param name name of vulnerability
     * @param status status of vulnerability
     * @return vulnerability
     */
    fun findByNameAndStatus(name: String, status: VulnerabilityStatus): Vulnerability?

    /**
     * @param vulnerabilityIdentifier identifier of vulnerability
     * @param status status of vulnerability
     * @return vulnerability
     */
    fun findByVulnerabilityIdentifierAndStatus(vulnerabilityIdentifier: String, status: VulnerabilityStatus): Vulnerability?

    /**
     * @param userId creator of vulnerability
     * @return list of vulnerabilities
     */
    fun findByUserId(userId: Long): List<Vulnerability>

    /**
     * @param userId id of user
     * @param status status of vulnerability
     * @return count of vulnerabilities
     */
    fun countByUserIdAndStatus(userId: Long, status: VulnerabilityStatus): Int

    /**
     * @param organizationName name of organization
     * @param status status of vulnerability
     * @return list of vulnerabilities
     */
    fun findByOrganizationNameAndStatus(organizationName: String, status: VulnerabilityStatus): List<Vulnerability>

    /**
     * @param prefixName prefixName of vulnerability
     * @param status status of vulnerability
     * @return vulnerabilities
     */
    fun findByNameStartingWithAndStatus(prefixName: String, status: VulnerabilityStatus): List<Vulnerability>
}
