name: Create PR for new version of backend api spec
on:
  schedule:
    # triggers the workflow every day at 5:45 UTC
    - cron: '45 5 * * *'

# FixMe: Properly should be:
#  push:
#    branches:
#      - 'infra/update-backend-api-spec'

jobs:
  create_pr_for_backend_api_spec:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          ref: 'infra/update-backend-api-spec'

      - name: Create Pull Request
        run: |
          gh pr create -B master -H infra/update-backend-api-spec \
          --title '[Update] New version of backend api spec' \
          --body 'Update backend api spec [auto-generated]'

        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
